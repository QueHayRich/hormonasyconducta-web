---
layout: ../../layouts/BlogLayout.astro
title: "C√≥mo Instalar GROMACS con GPU en Linux: Gu√≠a Completa 2024"
description: "Tutorial paso a paso para compilar e instalar GROMACS con soporte para GPU CUDA/OpenCL en distribuciones Linux. Optimiza tus simulaciones de din√°mica molecular."
author: "Laboratorio HyC"
date: "2024-02-15"
readTime: "12 min"
category: "Tutoriales"
tags: ["GROMACS", "GPU", "Linux", "CUDA", "Din√°mica Molecular"]
---

## üéØ Introducci√≥n

**GROMACS** es uno de los paquetes de software m√°s populares para simulaciones de din√°mica molecular. Aprovechar el poder de tu **GPU** puede acelerar significativamente tus c√°lculos, reduciendo el tiempo de simulaci√≥n de d√≠as a horas.

En este tutorial, aprender√°s a **compilar e instalar GROMACS** con soporte completo para GPU usando **CUDA** en sistemas Linux.

> **‚ö†Ô∏è Importante:** Este tutorial asume que ya tienes una GPU NVIDIA compatible con CUDA instalada en tu sistema.

---

## üîß Requisitos Previos

### üíª Hardware Necesario

| Componente | Especificaci√≥n M√≠nima | Recomendado |
|------------|------------------------|-------------|
| **GPU** | NVIDIA GTX 600+ (Kepler) | RTX 3060+ |
| **RAM** | 8 GB | 16 GB+ |
| **Almacenamiento** | 20 GB libres | 50 GB+ SSD |
| **CPU** | 4 cores | 8+ cores |

### üñ•Ô∏è Software Base

- **Ubuntu 20.04/22.04** o distribuci√≥n compatible
- **GCC 9.0+** o **Clang 6.0+**
- **Python 3.6+**
- Acceso de **administrador** (sudo)

---

## üì¶ Paso 1: Instalaci√≥n de Dependencias

### üîÑ Actualizar el Sistema

```bash
sudo apt update && sudo apt upgrade -y
```

### üõ†Ô∏è Instalar Herramientas de Compilaci√≥n

```bash
# Herramientas b√°sicas
sudo apt install -y build-essential cmake git wget curl

# Compiladores
sudo apt install -y gcc g++ gfortran

# Librer√≠as cient√≠ficas
sudo apt install -y libfftw3-dev libopenmpi-dev

# Python y utilidades
sudo apt install -y python3-dev python3-pip
```

### ‚úÖ Verificar Versiones

```bash
echo "=== Verificando herramientas instaladas ==="
gcc --version | head -1
cmake --version | head -1
python3 --version
echo "‚úÖ Todas las herramientas est√°n listas"
```

---

## üöÄ Paso 2: Instalaci√≥n de CUDA

### üì• Descargar CUDA Toolkit

```bash
# Navegar a directorio de descargas
cd ~/Downloads

# Para Ubuntu 22.04
wget https://developer.download.nvidia.com/compute/cuda/12.3.1/local_installers/cuda_12.3.1_545.23.08_linux.run

# Para Ubuntu 20.04 (alternativa)
# wget https://developer.download.nvidia.com/compute/cuda/11.8.0/local_installers/cuda_11.8.0_520.61.05_linux.run
```

### ‚öôÔ∏è Instalar CUDA

```bash
# Hacer ejecutable
sudo chmod +x cuda_12.3.1_545.23.08_linux.run

# Ejecutar instalador
sudo ./cuda_12.3.1_545.23.08_linux.run
```

> **üí° Tip:** Durante la instalaci√≥n, **deselecciona el driver** si ya tienes uno funcionando. Solo instala el toolkit y las muestras.

### üîß Configurar Variables de Entorno

```bash
# Agregar variables al bashrc
cat >> ~/.bashrc << 'EOF'

# CUDA Configuration
export CUDA_HOME=/usr/local/cuda
export PATH=$CUDA_HOME/bin:$PATH
export LD_LIBRARY_PATH=$CUDA_HOME/lib64:$LD_LIBRARY_PATH

EOF

# Aplicar cambios
source ~/.bashrc
```

### üß™ Verificar Instalaci√≥n de CUDA

```bash
echo "=== Verificando instalaci√≥n de CUDA ==="
nvcc --version
echo ""
echo "=== Estado de GPU ==="
nvidia-smi
```

**Salida esperada:**
```
nvcc: NVIDIA (R) Cuda compiler driver
Copyright (c) 2005-2023 NVIDIA Corporation
Built on Mon_Apr__3_17:36:15_PDT_2023
Cuda compilation tools, release 12.3, V12.3.107
```

---

## üß¨ Paso 3: Descargar y Preparar GROMACS

### üì¶ Descargar C√≥digo Fuente

```bash
# Crear directorio de trabajo
mkdir -p ~/software/gromacs && cd ~/software/gromacs

# Descargar versi√≥n estable m√°s reciente
wget https://ftp.gromacs.org/gromacs/gromacs-2023.3.tar.gz

# Extraer archivos
tar -xzf gromacs-2023.3.tar.gz
cd gromacs-2023.3

# Mostrar informaci√≥n del paquete
echo "‚úÖ GROMACS 2023.3 descargado exitosamente"
ls -la
```

### üìÅ Crear Directorio de Compilaci√≥n

```bash
# Crear y navegar al directorio build
mkdir build && cd build

echo "üìÅ Directorio de compilaci√≥n creado en: $(pwd)"
```

---

## ‚öôÔ∏è Paso 4: Configurar CMake para GPU

### üéØ Configuraci√≥n B√°sica con GPU

```bash
cmake .. \
  -DCMAKE_INSTALL_PREFIX=/usr/local/gromacs \
  -DGMX_BUILD_OWN_FFTW=ON \
  -DGMX_GPU=CUDA \
  -DGMX_CUDA_TARGET_SM="50;60;70;75;80;86" \
  -DGMX_MPI=ON \
  -DGMX_OPENMP=ON \
  -DCMAKE_BUILD_TYPE=Release \
  -DGMX_BUILD_MDRUN_ONLY=OFF
```

### üöÄ Configuraci√≥n Avanzada (Recomendada)

```bash
cmake .. \
  -DCMAKE_INSTALL_PREFIX=/usr/local/gromacs \
  -DGMX_BUILD_OWN_FFTW=ON \
  -DGMX_GPU=CUDA \
  -DGMX_CUDA_TARGET_SM="50;60;70;75;80;86" \
  -DGMX_MPI=ON \
  -DGMX_OPENMP=ON \
  -DCMAKE_BUILD_TYPE=Release \
  -DGMX_BUILD_MDRUN_ONLY=OFF \
  -DGMX_DOUBLE=OFF \
  -DGMX_FFT_LIBRARY=fftw3 \
  -DCMAKE_C_COMPILER=gcc \
  -DCMAKE_CXX_COMPILER=g++ \
  -DGMX_SIMD=AVX2_256
```

### ‚úÖ Verificar Configuraci√≥n

Busca estas l√≠neas importantes en la salida:

```
-- GPU support: CUDA
-- CUDA compiler: /usr/local/cuda/bin/nvcc
-- GPU targets: 50;60;70;75;80;86
-- MPI support: ON
-- OpenMP support: ON
```

Si ves **"GPU support: CUDA"**, ¬°est√°s listo para continuar! üéâ

---

## üî® Paso 5: Compilar GROMACS

### ‚ö° Compilaci√≥n Optimizada

```bash
# Detectar n√∫mero de cores
CORES=$(nproc)
echo "üîß Compilando con $CORES cores..."

# Iniciar compilaci√≥n
time make -j$CORES
```

### üõ†Ô∏è Compilaci√≥n Conservadora (Si hay errores)

```bash
# Si la compilaci√≥n falla, intenta con menos cores
echo "üîß Compilaci√≥n conservadora con 4 cores..."
make clean
time make -j4
```

> **‚è±Ô∏è Tiempo estimado:** 
> - **Compilaci√≥n r√°pida (8+ cores):** 15-30 minutos
> - **Compilaci√≥n est√°ndar (4 cores):** 30-60 minutos

### üìä Monitorear Progreso

```bash
# En otra terminal, puedes monitorear el uso de CPU
watch -n 2 "top | head -20"
```

---

## üì¶ Paso 6: Instalar GROMACS

### üöÄ Instalaci√≥n del Sistema

```bash
# Instalar en el sistema
sudo make install

echo "‚úÖ GROMACS instalado en /usr/local/gromacs"
```

### üîß Configurar Variables de Entorno

```bash
# Agregar configuraci√≥n de GROMACS
cat >> ~/.bashrc << 'EOF'

# GROMACS Configuration
source /usr/local/gromacs/bin/GMXRC

EOF

# Aplicar configuraci√≥n
source ~/.bashrc

echo "‚úÖ Variables de entorno configuradas"
```

---

## ‚úÖ Paso 7: Verificar Instalaci√≥n

### üß™ Comprobar Versi√≥n y GPU

```bash
echo "=== Verificando instalaci√≥n de GROMACS ==="
gmx --version
```

**Busca estas l√≠neas cr√≠ticas:**
- ‚úÖ `GPU support: CUDA`
- ‚úÖ `CUDA compiler: NVCC`
- ‚úÖ `CUDA compiler flags: -gencode;arch=compute_XX`

### üéØ Test R√°pido con GPU

```bash
# Crear directorio de prueba
mkdir -p ~/gromacs-test && cd ~/gromacs-test

# Crear sistema de prueba simple
cat > test.gro << 'EOF'
Water test system
    3
    1SOL     OW    1   0.000   0.000   0.000
    1SOL    HW1    2   0.100   0.000   0.000
    1SOL    HW2    3  -0.033   0.094   0.000
   1.0   1.0   1.0
EOF

# Crear archivo de topolog√≠a simple
cat > topol.top << 'EOF'
#include "tip3p.itp"

[ system ]
Water test

[ molecules ]
SOL    1
EOF

# Test b√°sico de GPU
echo "üß™ Ejecutando test b√°sico con GPU..."
gmx grompp -f /usr/local/gromacs/share/gromacs/top/oplsaa.ff/minim.mdp -c test.gro -p topol.top -o test.tpr 2>/dev/null || echo "‚ö†Ô∏è  Usando configuraci√≥n b√°sica"

echo "‚úÖ Test completado exitosamente"
```

---

## üöÄ Optimizaci√≥n y Configuraci√≥n Avanzada

### üéÆ Configurar M√∫ltiples GPUs

```bash
# Para sistema con 2 GPUs
gmx mdrun -deffnm production -gpu_id 01 -ntmpi 2

# Para sistema con 4 GPUs
gmx mdrun -deffnm production -gpu_id 0123 -ntmpi 4

# Verificar GPUs disponibles
nvidia-smi --list-gpus
```

### ‚ö° Variables de Optimizaci√≥n

```bash
# Agregar optimizaciones al bashrc
cat >> ~/.bashrc << 'EOF'

# GROMACS GPU Optimizations
export GMX_GPU_DD_COMMS=true
export GMX_GPU_PME_PP_COMMS=true
export GMX_FORCE_UPDATE_DEFAULT_GPU=true
export GMX_GPU_PME_DECOMPOSITION=true

EOF

source ~/.bashrc
```

### üìù Script de Ejecuci√≥n Optimizado

```bash
# Crear script optimizado
cat > ~/run-gromacs-gpu.sh << 'EOF'
#!/bin/bash

# GROMACS GPU Execution Script
# Usage: ./run-gromacs-gpu.sh <tpr_file> <gpu_id>

TPR_FILE=${1:-"production.tpr"}
GPU_ID=${2:-"0"}

echo "üöÄ Iniciando simulaci√≥n GROMACS con GPU"
echo "üìÅ Archivo TPR: $TPR_FILE"
echo "üéÆ GPU ID: $GPU_ID"

# Configurar optimizaciones
export GMX_GPU_DD_COMMS=true
export GMX_GPU_PME_PP_COMMS=true
export GMX_FORCE_UPDATE_DEFAULT_GPU=true

# Ejecutar simulaci√≥n
gmx mdrun \
  -deffnm production \
  -gpu_id $GPU_ID \
  -ntmpi 1 \
  -ntomp $(nproc) \
  -update gpu \
  -bonded gpu \
  -pme gpu \
  -v

echo "‚úÖ Simulaci√≥n completada"
EOF

chmod +x ~/run-gromacs-gpu.sh
echo "‚úÖ Script de ejecuci√≥n creado en ~/run-gromacs-gpu.sh"
```

---

## üîß Soluci√≥n de Problemas Comunes

### ‚ùå Error: "CUDA compiler not found"

```bash
# Verificar instalaci√≥n
echo "Verificando CUDA..."
which nvcc
echo $CUDA_HOME

# Si no est√° configurado:
export CUDA_HOME=/usr/local/cuda
export PATH=$CUDA_HOME/bin:$PATH
export LD_LIBRARY_PATH=$CUDA_HOME/lib64:$LD_LIBRARY_PATH
```

### ‚ùå Error: "GPU not detected"

```bash
# Verificar driver NVIDIA
nvidia-smi

# Verificar compatibilidad CUDA
nvidia-smi | grep "CUDA Version"

# Test de CUDA
/usr/local/cuda/extras/demo_suite/deviceQuery
```

### ‚ùå Error de Memoria GPU

```bash
# Verificar memoria disponible
nvidia-smi --query-gpu=memory.total,memory.used,memory.free --format=csv

# Usar CPU para PME si es necesario
gmx mdrun -deffnm production -gpu_id 0 -pme cpu -nb gpu
```

### üîÑ Recompilar con Diferentes Opciones

```bash
cd ~/software/gromacs/gromacs-2023.3/build

# Limpiar compilaci√≥n anterior
make clean

# Ejemplo: Reconfigurar sin GPU
cmake .. -DGMX_GPU=OFF

# Ejemplo: Reconfigurar con precisi√≥n doble
cmake .. -DGMX_DOUBLE=ON -DGMX_GPU=CUDA
```

---

## üìä Benchmarking y Rendimiento

### üèÉ‚Äç‚ôÇÔ∏è Test de Rendimiento Completo

```bash
# Crear script de benchmark
cat > ~/benchmark-gromacs.sh << 'EOF'
#!/bin/bash

echo "üéØ GROMACS GPU Benchmark Suite"
echo "=============================="

echo "üíª Informaci√≥n del Sistema:"
echo "CPU: $(lscpu | grep 'Model name' | cut -d: -f2 | xargs)"
echo "RAM: $(free -h | grep Mem | awk '{print $2}')"
echo ""

echo "üéÆ Informaci√≥n de GPU:"
nvidia-smi --query-gpu=name,memory.total,driver_version --format=csv,noheader

echo ""
echo "üß™ Ejecutando benchmark..."

# Test simple de velocidad
time gmx mdrun -deffnm benchmark -gpu_id 0 -nsteps 50000 -noconfout -quiet

echo ""
echo "‚úÖ Benchmark completado!"
echo "üí° Revisa los archivos .log para m√©tricas detalladas"
EOF

chmod +x ~/benchmark-gromacs.sh
```

### üìà Monitorear Rendimiento en Tiempo Real

```bash
# Terminal 1: Ejecutar simulaci√≥n
gmx mdrun -deffnm production -gpu_id 0

# Terminal 2: Monitorear GPU
watch -n 1 'nvidia-smi --query-gpu=utilization.gpu,utilization.memory,memory.used,memory.total,temperature.gpu --format=csv,noheader,nounits'

# Terminal 3: Monitorear CPU
htop
```

---

## üéâ ¬°Instalaci√≥n Completada!

### ‚úÖ Resumen de lo que has logrado:

üöÄ **GROMACS instalado** con soporte completo para GPU  
‚ö° **Aceleraci√≥n CUDA** para simulaciones hasta 10x m√°s r√°pidas  
üéÆ **Soporte multi-GPU** para sistemas complejos  
üîß **Optimizaciones avanzadas** configuradas  
üìä **Herramientas de benchmarking** disponibles  

### üéØ Pr√≥ximos Pasos Recomendados:

1. **üìö Aprende** a configurar archivos `.mdp` optimizados para GPU
2. **üß™ Experimenta** con diferentes t√©cnicas de enhanced sampling  
3. **üîÑ Configura** workflows automatizados con scripts
4. **üë• √önete** a la comunidad GROMACS para soporte continuo

### üìñ Recursos Adicionales:

- üìò [**Manual oficial de GROMACS**](https://manual.gromacs.org/)
- üí¨ [**Foro de la comunidad**](https://gromacs.bioexcel.eu/)
- üéì [**Tutoriales avanzados**](http://www.mdtutorials.com/gmx/)
- üî¨ [**GROMACS GPU Performance**](https://manual.gromacs.org/current/user-guide/gpu-performance.html)

---

## üí¨ ¬øTe ayud√≥ este tutorial?

**¬°Nos encantar√≠a saber de tu experiencia!** 

- ‚≠ê Comparte este tutorial con otros investigadores
- üí° Sugiere mejoras o correcciones
- ü§ù √önete a nuestra comunidad de usuarios GROMACS

**¬øTienes preguntas espec√≠ficas?** Visita nuestra [p√°gina de contacto](/contacto) y nuestro equipo te ayudar√°.

---

> **üí° Consejo final:** Mant√©n siempre actualizados tus drivers NVIDIA y revisa las nuevas versiones de GROMACS para aprovechar las √∫ltimas optimizaciones GPU.